[
  {
    "type": "function",
    "function": {
      "name": "create_project",
      "description": "Create a project or life scope directory and ensure canonical markdown scaffold files exist. When files are omitted or partial, required scope files are auto-filled.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "Project directory path under the library."
          },
          "name": {
            "type": "string",
            "description": "Project name (defaults to projects/active/<name>)."
          },
          "files": {
            "type": "array",
            "description": "Optional list of files to create; use create_project_scaffold for canonical AGENT/spec/build-plan scaffolds.",
            "items": {
              "type": "object",
              "properties": {
                "path": {
                  "type": "string"
                },
                "content": {
                  "type": "string"
                }
              },
              "required": [
                "path",
                "content"
              ]
            }
          }
        },
        "oneOf": [
          {
            "required": [
              "path"
            ]
          },
          {
            "required": [
              "name"
            ]
          }
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "create_markdown",
      "description": "Create a markdown file with the provided content.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "content": {
            "type": "string"
          }
        },
        "required": [
          "path",
          "content"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "read_markdown",
      "description": "Read markdown content and metadata.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          }
        },
        "required": [
          "path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "list_markdown_files",
      "description": "List markdown files under a directory.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          }
        },
        "required": [
          "path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "list_projects",
      "description": "List projects under a directory (defaults to projects/active, falls back to projects). Use this to answer 'what projects exist' questions; call with {} when no path is provided.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          }
        }
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "project_exists",
      "description": "Check whether a project directory exists (checks projects/active/<name> and projects/<name> when given a name). Use this for 'does project exist' questions; pass name or path, not a markdown file.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "name": {
            "type": "string"
          }
        },
        "oneOf": [
          {
            "required": [
              "path"
            ]
          },
          {
            "required": [
              "name"
            ]
          }
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "search_markdown",
      "description": "Search for a substring within markdown files.",
      "parameters": {
        "type": "object",
        "properties": {
          "query": {
            "type": "string"
          },
          "path": {
            "type": "string"
          }
        },
        "required": [
          "query"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "preview_markdown_change",
      "description": "Preview a markdown edit without writing.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "operation": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string"
              },
              "content": {
                "type": "string"
              },
              "target": {
                "type": "string"
              }
            },
            "required": [
              "type",
              "content"
            ]
          }
        },
        "required": [
          "path",
          "operation"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "write_markdown",
      "description": "Append or prepend content to a markdown file.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "operation": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string"
              },
              "content": {
                "type": "string"
              }
            },
            "required": [
              "type",
              "content"
            ]
          }
        },
        "required": [
          "path",
          "operation"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "edit_markdown",
      "description": "Edit a markdown section by heading.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "operation": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string"
              },
              "content": {
                "type": "string"
              },
              "target": {
                "type": "string"
              }
            },
            "required": [
              "type",
              "content",
              "target"
            ]
          }
        },
        "required": [
          "path",
          "operation"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "delete_markdown",
      "description": "Delete a markdown file (requires confirm).",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "confirm": {
            "type": "boolean"
          }
        },
        "required": [
          "path",
          "confirm"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "create_directory",
      "description": "Create a directory under the library (optionally create .gitkeep).",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "gitkeep": {
            "type": "boolean"
          }
        },
        "required": [
          "path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "list_directory",
      "description": "List files and directories under a path.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "recursive": {
            "type": "boolean"
          },
          "include_files": {
            "type": "boolean"
          },
          "include_dirs": {
            "type": "boolean"
          }
        },
        "required": [
          "path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "read_file_metadata",
      "description": "Read metadata for any file or directory.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          }
        },
        "required": [
          "path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "move_path",
      "description": "Move or rename a file or directory.",
      "parameters": {
        "type": "object",
        "properties": {
          "from_path": {
            "type": "string"
          },
          "to_path": {
            "type": "string"
          },
          "overwrite": {
            "type": "boolean"
          }
        },
        "required": [
          "from_path",
          "to_path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "copy_path",
      "description": "Copy a file or directory.",
      "parameters": {
        "type": "object",
        "properties": {
          "from_path": {
            "type": "string"
          },
          "to_path": {
            "type": "string"
          },
          "overwrite": {
            "type": "boolean"
          }
        },
        "required": [
          "from_path",
          "to_path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "delete_path",
      "description": "Delete a file or directory (requires confirm).",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "confirm": {
            "type": "boolean"
          },
          "recursive": {
            "type": "boolean"
          }
        },
        "required": [
          "path",
          "confirm"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "write_binary",
      "description": "Write a base64-encoded binary file.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "content_base64": {
            "type": "string"
          },
          "content_type": {
            "type": "string"
          }
        },
        "required": [
          "path",
          "content_base64"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "project_context",
      "description": "Return key project files and metadata in one response (AGENT.md, spec.md, build-plan.md, decisions.md, ideas.md by default).",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "include_files": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "include_transcripts": {
            "type": "boolean"
          }
        },
        "oneOf": [
          {
            "required": [
              "path"
            ]
          },
          {
            "required": [
              "name"
            ]
          }
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "create_project_scaffold",
      "description": "Create a project scaffold with AGENT.md, spec.md, build-plan.md, decisions.md, and ideas.md.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "name": {
            "type": "string"
          }
        },
        "oneOf": [
          {
            "required": [
              "path"
            ]
          },
          {
            "required": [
              "name"
            ]
          }
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "ensure_scope_scaffold",
      "description": "Ensure canonical scaffold files exist for a project/life scope path.",
      "x-safety-class": "mutating",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "name": {
            "type": "string"
          }
        },
        "oneOf": [
          {
            "required": [
              "path"
            ]
          },
          {
            "required": [
              "name"
            ]
          }
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "bootstrap_user_library",
      "description": "Idempotently ensure the canonical user-scoped library scaffold exists (AGENT.md contract, life specs/plans, pulse/completed, schema-version).",
      "x-safety-class": "mutating",
      "parameters": {
        "type": "object",
        "properties": {}
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "get_onboarding_state",
      "description": "Return onboarding completion state across starter life topics.",
      "x-safety-class": "read_only",
      "parameters": {
        "type": "object",
        "properties": {}
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "start_topic_onboarding",
      "description": "Start onboarding for a life topic and return interview seed content.",
      "x-safety-class": "mutating",
      "parameters": {
        "type": "object",
        "properties": {
          "topic": {
            "type": "string",
            "enum": [
              "finances",
              "fitness",
              "relationships",
              "career",
              "whyfinder"
            ]
          }
        },
        "required": [
          "topic"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "save_topic_onboarding_context",
      "description": "Persist approved onboarding interview context into topic docs.",
      "x-safety-class": "mutating",
      "parameters": {
        "type": "object",
        "properties": {
          "topic": {
            "type": "string",
            "enum": [
              "finances",
              "fitness",
              "relationships",
              "career",
              "whyfinder"
            ]
          },
          "context": {
            "type": "string"
          },
          "approved": {
            "type": "boolean"
          },
          "question": {
            "type": "string",
            "description": "The exact interview question asked for this turn."
          },
          "answer": {
            "type": "string",
            "description": "The user's answer to the interview question for this turn."
          },
          "phase": {
            "type": "string",
            "enum": [
              "not_started",
              "opening",
              "goals_tasks",
              "followup",
              "complete"
            ],
            "description": "Current onboarding phase for tracker updates."
          },
          "question_index": {
            "type": "integer",
            "minimum": 0
          },
          "question_total": {
            "type": "integer",
            "minimum": 0
          },
          "next_followup_due_at_utc": {
            "type": "string",
            "description": "Optional ISO timestamp for next follow-up interview touchpoint."
          },
          "future_interview_topics": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "finances",
                "fitness",
                "relationships",
                "career",
                "whyfinder"
              ]
            },
            "description": "Optional future interview topic queue hints."
          }
        },
        "required": [
          "topic",
          "context",
          "approved"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "complete_topic_onboarding",
      "description": "Mark onboarding complete for a topic and return the next recommendation.",
      "x-safety-class": "mutating",
      "parameters": {
        "type": "object",
        "properties": {
          "topic": {
            "type": "string",
            "enum": [
              "finances",
              "fitness",
              "relationships",
              "career",
              "whyfinder"
            ]
          },
          "summary": {
            "type": "string"
          },
          "next_followup_due_at_utc": {
            "type": "string",
            "description": "Optional ISO timestamp for the next follow-up interview."
          },
          "future_interview_topics": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "finances",
                "fitness",
                "relationships",
                "career",
                "whyfinder"
              ]
            },
            "description": "Optional suggested future interview topics."
          }
        },
        "required": [
          "topic"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "rebuild_profile_context",
      "description": "Rebuild me/profile.md from approved onboarding facts.",
      "x-safety-class": "mutating",
      "parameters": {
        "type": "object",
        "properties": {
          "facts": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "topics": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "finances",
                "fitness",
                "relationships",
                "career",
                "whyfinder"
              ]
            }
          }
        }
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "list_tasks",
      "description": "List tasks from the pulse system with optional filters.",
      "parameters": {
        "type": "object",
        "properties": {
          "owner": {
            "type": "string"
          },
          "priority": {
            "type": "string"
          },
          "tag": {
            "type": "string"
          },
          "status": {
            "type": "string"
          },
          "project": {
            "type": "string"
          },
          "scope": {
            "type": "string"
          },
          "path": {
            "type": "string"
          }
        }
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "create_task",
      "description": "Create a task in pulse/index.md with an auto-generated ID.",
      "parameters": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string"
          },
          "owner": {
            "type": "string"
          },
          "priority": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "project": {
            "type": "string"
          },
          "due": {
            "type": "string"
          },
          "scope": {
            "type": "string"
          },
          "path": {
            "type": "string"
          }
        },
        "required": [
          "title"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "update_task",
      "description": "Update an existing task by ID.",
      "parameters": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "fields": {
            "type": "object"
          }
        },
        "required": [
          "id",
          "fields"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "complete_task",
      "description": "Mark a task complete and move it to pulse/completed/YYYY-MM.md.",
      "parameters": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          }
        },
        "required": [
          "id"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "reopen_task",
      "description": "Reopen a completed task and move it back to pulse/index.md.",
      "parameters": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          }
        },
        "required": [
          "id"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "ingest_transcript",
      "description": "Store a transcript and update transcripts/index.md.",
      "x-safety-class": "mutating",
      "parameters": {
        "type": "object",
        "properties": {
          "content": {
            "type": "string"
          },
          "filename": {
            "type": "string"
          },
          "date": {
            "type": "string"
          },
          "project": {
            "type": "string"
          },
          "source": {
            "type": "string"
          }
        },
        "required": [
          "content"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "read_activity_log",
      "description": "Read entries from the activity log with optional filters.",
      "parameters": {
        "type": "object",
        "properties": {
          "limit": {
            "type": "integer"
          },
          "since": {
            "type": "string"
          }
        }
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "digest_snapshot",
      "description": "Return open tasks, recent completions, and activity entries for digest generation.",
      "parameters": {
        "type": "object",
        "properties": {
          "owner": {
            "type": "string"
          },
          "priority": {
            "type": "string"
          },
          "tag": {
            "type": "string"
          },
          "project": {
            "type": "string"
          },
          "include_completed": {
            "type": "boolean"
          },
          "completed_limit": {
            "type": "integer"
          },
          "activity_since": {
            "type": "string"
          },
          "activity_limit": {
            "type": "integer"
          }
        }
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "rollup_digest_period",
      "description": "Rebuild weekly, monthly, or yearly digest rollups from daily canonical entries.",
      "x-safety-class": "mutating",
      "parameters": {
        "type": "object",
        "properties": {
          "period": {
            "type": "string",
            "enum": [
              "week",
              "month",
              "year"
            ]
          },
          "target_date": {
            "type": "string",
            "description": "Optional target date in YYYY-MM-DD format. Defaults to today."
          }
        },
        "required": [
          "period"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "preview_move_path",
      "description": "Preview a move by listing the affected paths.",
      "parameters": {
        "type": "object",
        "properties": {
          "from_path": {
            "type": "string"
          },
          "to_path": {
            "type": "string"
          },
          "overwrite": {
            "type": "boolean"
          }
        },
        "required": [
          "from_path",
          "to_path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "preview_copy_path",
      "description": "Preview a copy by listing the affected paths.",
      "parameters": {
        "type": "object",
        "properties": {
          "from_path": {
            "type": "string"
          },
          "to_path": {
            "type": "string"
          },
          "overwrite": {
            "type": "boolean"
          }
        },
        "required": [
          "from_path",
          "to_path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "preview_delete_path",
      "description": "Preview a delete by listing the affected paths.",
      "parameters": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string"
          },
          "recursive": {
            "type": "boolean"
          }
        },
        "required": [
          "path"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "preview_bulk_changes",
      "description": "Preview multiple markdown changes and return diffs per file.",
      "parameters": {
        "type": "object",
        "properties": {
          "changes": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "path": {
                  "type": "string"
                },
                "action": {
                  "type": "string"
                },
                "operation": {
                  "type": "object"
                },
                "content": {
                  "type": "string"
                }
              },
              "required": [
                "path",
                "action"
              ]
            }
          }
        },
        "required": [
          "changes"
        ]
      }
    }
  },
  {
    "type": "function",
    "function": {
      "name": "score_digest_tasks",
      "description": "Score and rank tasks for digest display.",
      "parameters": {
        "type": "object",
        "properties": {
          "tasks": {
            "type": "array",
            "items": {
              "type": "object"
            }
          },
          "focus_project": {
            "type": "string"
          },
          "now": {
            "type": "string"
          }
        },
        "required": [
          "tasks"
        ]
      }
    }
  }
]
